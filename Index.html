<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome to Favorites</title>
    <!-- Link to the shared CSS file -->
    <link rel="stylesheet" href="style.css">
    <!-- Google Fonts and Tailwind for utility classes -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="bg-gray-900 text-gray-200 flex items-center justify-center min-h-screen">

    <div class="w-full max-w-md mx-4">
        <!-- Login View -->
        <div id="login-view" class="view bg-gray-800 p-8 rounded-2xl shadow-2xl">
            <div class="text-center mb-8">
                <h1 class="text-4xl font-bold text-white mb-2">Welcome Back</h1>
                <p class="text-gray-400">Sign in to continue</p>
            </div>
            <form id="login-form">
                <div class="mb-4">
                    <label for="login-identifier" class="block text-sm font-medium text-gray-300 mb-2">Username or Email</label>
                    <input type="text" id="login-identifier" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg" placeholder="you@example.com" required>
                </div>
                <div class="mb-4">
                    <label for="login-password" class="block text-sm font-medium text-gray-300 mb-2">Password</label>
                    <input type="password" id="login-password" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg" placeholder="••••••••" required>
                </div>
                <div class="text-right mb-6">
                    <a href="#" id="forgot-password-link" class="text-sm text-blue-400 hover:underline">Forgot password?</a>
                </div>
                <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition transform hover:scale-105">Login</button>
            </form>
            <div id="login-message" class="text-red-400 text-center mt-4 text-sm"></div>
            <div class="flex items-center my-6">
                <div class="flex-grow border-t border-gray-600"></div>
                <span class="mx-4 text-gray-500 text-sm">OR</span>
                <div class="flex-grow border-t border-gray-600"></div>
            </div>
            <button class="w-full bg-white text-gray-800 font-semibold py-3 px-4 rounded-lg border border-gray-300 hover:bg-gray-100 flex items-center justify-center transition transform hover:scale-105">
                <svg class="w-6 h-6 mr-3" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path fill="#FFC107" d="M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"></path><path fill="#FF3D00" d="M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"></path><path fill="#4CAF50" d="M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"></path><path fill="#1976D2" d="M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571l6.19,5.238C42.022,35.244,44,30.036,44,24C44,22.659,43.862,21.35,43.611,20.083z"></path></svg>
                Login with Google
            </button>
            <p class="text-center mt-6 text-sm">
                Don't have an account? <a href="#" id="show-signup-link" class="text-blue-400 hover:underline">Sign Up</a>
            </p>
        </div>

        <!-- Sign Up View (Initially Hidden) -->
        <div id="signup-view" class="view hidden bg-gray-800 p-8 rounded-2xl shadow-2xl">
             <div class="text-center mb-8">
                <h1 class="text-4xl font-bold text-white mb-2">Create Account</h1>
                <p class="text-gray-400">Get started with us</p>
            </div>
            <form id="signup-form">
                <div class="mb-4">
                    <label for="signup-username" class="block text-sm font-medium text-gray-300 mb-2">Username</label>
                    <input type="text" id="signup-username" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg" required>
                </div>
                <div class="mb-4">
                    <label for="signup-email" class="block text-sm font-medium text-gray-300 mb-2">Email</label>
                    <input type="email" id="signup-email" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg" required>
                </div>
                <div class="mb-6">
                    <label for="signup-password" class="block text-sm font-medium text-gray-300 mb-2">Password</label>
                    <input type="password" id="signup-password" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg" required>
                </div>
                <button type="submit" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded-lg transition transform hover:scale-105">Sign Up</button>
            </form>
            <div id="signup-message" class="text-red-400 text-center mt-4 text-sm"></div>
            <p class="text-center mt-6 text-sm">
                Already have an account? <a href="#" id="show-login-link-from-signup" class="text-blue-400 hover:underline">Login</a>
            </p>
        </div>

        <!-- Forgot Password View (Initially Hidden) -->
        <div id="forgot-view" class="view hidden bg-gray-800 p-8 rounded-2xl shadow-2xl">
             <div class="text-center mb-8">
                <h1 class="text-4xl font-bold text-white mb-2">Reset Password</h1>
                <p class="text-gray-400">Enter your email to receive a reset link</p>
            </div>
            <form id="forgot-form">
                <div class="mb-6">
                    <label for="forgot-email" class="block text-sm font-medium text-gray-300 mb-2">Email or Username</label>
                    <input type="text" id="forgot-email" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg" required>
                </div>
                <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition transform hover:scale-105">Send Reset Link</button>
            </form>
            <div id="forgot-message" class="text-green-400 text-center mt-4 text-sm"></div>
            <p class="text-center mt-6 text-sm">
                Remembered your password? <a href="#" id="show-login-link-from-forgot" class="text-blue-400 hover:underline">Login</a>
            </p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- DOM Elements ---
            const loginView = document.getElementById('login-view');
            const signupView = document.getElementById('signup-view');
            const forgotView = document.getElementById('forgot-view');
            const loginForm = document.getElementById('login-form');
            const signupForm = document.getElementById('signup-form');
            const forgotForm = document.getElementById('forgot-form');
            const loginMessage = document.getElementById('login-message');
            const signupMessage = document.getElementById('signup-message');
            const forgotMessage = document.getElementById('forgot-message');
            const showSignupLink = document.getElementById('show-signup-link');
            const showLoginLinkFromSignup = document.getElementById('show-login-link-from-signup');
            const showLoginLinkFromForgot = document.getElementById('show-login-link-from-forgot');
            const forgotPasswordLink = document.getElementById('forgot-password-link');

            // --- View Switching Logic ---
            const showView = (viewToShow) => {
                [loginView, signupView, forgotView].forEach(view => view.classList.add('hidden'));
                viewToShow.classList.remove('hidden');
            };

            showSignupLink.addEventListener('click', (e) => { e.preventDefault(); showView(signupView); });
            forgotPasswordLink.addEventListener('click', (e) => { e.preventDefault(); showView(forgotView); });
            showLoginLinkFromSignup.addEventListener('click', (e) => { e.preventDefault(); showView(loginView); });
            showLoginLinkFromForgot.addEventListener('click', (e) => { e.preventDefault(); showView(loginView); });

            // --- User Data Management (using localStorage) ---
            const getUsers = () => JSON.parse(localStorage.getItem('users')) || {};
            const saveUsers = (users) => localStorage.setItem('users', JSON.stringify(users));

            // --- Sign Up Form Handler ---
            signupForm.addEventListener('submit', (e) => {
                e.preventDefault();
                signupMessage.textContent = '';
                const users = getUsers();
                const username = document.getElementById('signup-username').value;
                const email = document.getElementById('signup-email').value;
                const password = document.getElementById('signup-password').value;

                if (Object.values(users).some(user => user.email === email)) {
                    signupMessage.textContent = 'An account with this email already exists.';
                    return;
                }
                if (Object.values(users).some(user => user.username.toLowerCase() === username.toLowerCase())) {
                    signupMessage.textContent = 'This username is already taken.';
                    return;
                }

                const newUserId = 'user_' + Date.now();
                users[newUserId] = {
                    id: newUserId,
                    username,
                    email,
                    password, // In a real app, ALWAYS hash passwords.
                    bio: 'This is my new bio!',
                    picture: `https://placehold.co/150x150/1f2937/a0aec0?text=${username.charAt(0).toUpperCase()}`
                };
                saveUsers(users);
                
                // Log the user in and redirect
                localStorage.setItem('currentUser', newUserId);
                window.location.href = 'profile.html';
            });

            // --- Login Form Handler ---
            loginForm.addEventListener('submit', (e) => {
                e.preventDefault();
                loginMessage.textContent = '';
                const users = getUsers();
                const identifier = document.getElementById('login-identifier').value.toLowerCase();
                const password = document.getElementById('login-password').value;

                const foundUser = Object.values(users).find(user => 
                    (user.email.toLowerCase() === identifier || user.username.toLowerCase() === identifier) &&
                    user.password === password
                );

                if (foundUser) {
                    localStorage.setItem('currentUser', foundUser.id);
                    window.location.href = 'profile.html';
                } else {
                    loginMessage.textContent = 'Invalid username/email or password.';
                }
            });

            // --- Forgot Password Form Handler ---
            forgotForm.addEventListener('submit', (e) => {
                e.preventDefault();
                forgotMessage.textContent = `If an account exists, a reset link has been sent.`;
                forgotForm.reset();
            });
        });
    </script>
</body>
</html>
